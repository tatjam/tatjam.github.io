Where can a solar sail go?
2025-06-18
Exploring solar sails and optimal control applied to a simplified case.
#
<script type="importmap">
	{
		"imports": {
			"three": "https://cdn.jsdelivr.net/npm/three@0.177.0/build/three.module.js",
            "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.177.0/examples/jsm/"
		}
	}
</script>
<script src="https://cdn.jsdelivr.net/npm/lil-gui@0.20"></script>
#

A solar sail is a spacecraft that purposefully exploits radiation pressure on its surface to change its velocity. Radiation pressure is typically extremely small (unless you happen to be in the immediate vicinity of an exploding nuclear bomb), and thus the forces generated are really only noticeable on space, where even tiny accelerations are useful.

The origin of this force is the fact that light carries momentum. It's useful, but not really correct physically, to just imagine light as a lot of tiny billboard balls, colliding with our spacecraft. The collision may be:

- Elastic (equivalent to a perfectly reflective surface), where the balls bounce off the surface of our spacecraft.
- Inelastic (equivalent to a perfectly black surface), where the balls stick to our spacecraft.
- A mix between the two.

The direction of the reflected balls will be assumed to respect an ideal collision with a flat plane, which is equivalent to assuming fully specular reflections. In reality, solar sail models consider a mixture between diffuse and specular reflections, and also consider transmission and diffraction [^1].

[^1]: Samuel M. Thompson, Nishanth Pushparaj, Chantal Cappelletti, *Reflective and transmissive solar sails: Dynamics, flight regimes and applications*.

# A very simple model of a solar sail

For simplicity, we may consider our solar sail to be a perfectly flat rectangle of area \\(A\\) with its normal vector pointing in direction \\(𝐧\\). We will assume that only solar radiation is meaningful, and it comes from a fixed direction \\(𝐬\\). The reflectivity of the sail is given by \\( ϵ ∈ [0, 1] \\), with 0 meaning the sail is perfectly black, and 1 meaning it's perfectly reflective.

The first component of the solar radiation force is that given by absorption of the light. The total quantity of light absorbed is 

$$
    ϕ_a = A \abs{𝐧 ⋅𝐬}, 
$$

noting that the dot product represents the projected area of the rectangle on the \\( 𝐬 \\) direction. The absolute value is taken because it doesn't really matter what side of our rectangle does the absorption.

The second component is given by the reflection of light, which is equivalent to emission of a quantity of light proportional to the absorbed quantity,   

$$
    ϕ_r = ϵ ϕ_a.
$$

Now, the momentum transfer is proportional to the quantity of light absorbed / reflected, and the momentum it carries. We may write the quantity of momentum per unit light as \\(p\\). Then, by Newton's second law, the force acting on our body due to absorption is

$$
    𝐅_a = ϕ_a p 𝐬.
$$

Note that this force acts in the direction of the incident light. Similarly, for reflection we have

$$
    𝐅_r = -ϕ_r p \, \text{reflect}(𝐬, 𝐧),
$$

where the reflect function is defined as 

$$
    \text{reflect}(𝐬, 𝐧) = 𝐬 - 2 (𝐧 ⋅ 𝐬) 𝐧.
$$

Adding both terms together, we find the total force on the sail is

$$
    𝐅 = p (ϕ_a 𝐬 + ϕ_r 𝐧) = p A \abs{𝐧 ⋅ 𝐬} (𝐬 - ϵ \, \text{reflect} (𝐬, 𝐧)),
$$

which we can simplify down to 

$$
    𝐅 = p A \abs{𝐧 ⋅ 𝐬} \left((1 - ϵ) 𝐬 + 2 ϵ (𝐧 ⋅ 𝐬) 𝐧\right)
$$

Note that, by increasing the reflectivity of the object, we can achieve some "thrust-vectoring" by means of rotating the sail. With a totally absorptive sail, the force will instead always push us away from the sun. Either way, the most efficient way to use the sail is to point it straight at the sun.

In the following video, the thrust generated by a rotating solar sail is shown for \\(ϵ = 0\\) (blue), \\( ϵ = 0.5 \\) (orange) and \\( ϵ = 1 \\) (green). The outer envelope is the maximum thrust. 

<div style="margin:auto; width:70%">
<video controls autoplay loop style="width:100%">
    <source src="/Mathematics/solar-sail-img/solarsail-1.mp4">
</video>
</div>

We can also see that increasing \\( ϵ \\) reduces the "sharpness" of the maximum thrust envelope, at the same time it increases in general magnitude.

<div style="margin:auto; width:60%">
<video controls autoplay loop style="width:100%">
    <source src="/Mathematics/solar-sail-img/solarsail-2.mp4">
</video>
</div>

This interesting thrust envelope makes the design of solar sail spacecraft missions trickier than conventional means of propulsion, not only due to the very reduced forces involved, but also due to this constraint on thrust direction. Ideally, to generate maximum thrust, we would always maneouver away from the sun! 



<!--
<p id="canvas-cont" style="position: relative; width: 100%; height: 500px;">
<canvas id="c" style="width:100%"></canvas>
</p>

<script type="module" src="/external/solar-sail.js"></script>
-->

# Optimal control of a solar sail

Now, back to the title of the blogpost. Given a solar sail of reflectivity \\( ϵ \\), which we assume to be freely maneouverable, how far can we maneouver on a given time limit? First of all, we need to more rigorously define what we mean by "far". We will consider the problem of changing the orbit's radius, as it sort of represents a maximal maneouver [^2]. 

[^2]: Note that there exist many maneouvers which don't change the radius of the orbit, but are nonetheless very useful. Such an example is a plane change maneouver. For simplicity, we will only consider this simple case of increasing the orbit's radius. 

The specific energy of the orbit (energy per unit mass), which is constant if no maneouvers are applied, is defined as 

$$
    E = \frac{1}{2} \norm{𝐯}^2 - \frac{μ}{\norm{𝐫}} = \frac{1}{2} 𝐯 ⋅ 𝐯 - \frac{μ}{\sqrt{𝐫 ⋅ 𝐫}},
$$

where \\(μ = G M \\) is the gravitational parameter of Earth.

Now consider a small change in velocity \\(\dd{𝐯}\\), the change in energy due to this change will be [^3]

$$
    \dd{E} = \pdv{E}{𝐯} ⋅\dd{𝐯} = \pdv{(\frac{1}{2} 𝐯 ⋅ 𝐯)}{𝐯} ⋅ \dd{𝐯} = 𝐯 ⋅ \dd{𝐯}. 
$$

It's thus apparent that a maximal change in energy happens if the thrust is aligned with velocity, and furthermore, the higher the velocity, the higher energy change we impart. This is the Oberth effect, which justifies why maneouvers are preferentially carried out near the periapsis of the central body. 

[^3]: Note that \\( \pdv{E}{𝐯} \\) is really the gradient of \\( E \\) with respect to velocity, but as the gradient is usually taken with respect to space, I've chosen to use this partial derivative notation.

## Equations of motion

The problem is that, with our solar sail, we won't always be able to offer maximal thrust in the direction of velocity. For simplicity, we will consider the 2D problem where the solar sail orientation is fully characterized by a single angle. We will consider such angle to be \\(α\\), which represents the angle between the solar sail's normal vector and the spacecraft-sun vector. This will be the "control input" to our problem.

This allows us to rewrite the thrust of the solar sail as 

$$
    𝐅 = p A \abs{\cos(α)} (𝐬 - ϵ ( 𝐬 - 2 \cos(α) 𝐧 )) = p A \abs{cos(α)} ( (1 - ϵ) 𝐬 + 2 \cos(α) 𝐧).
$$

We will write the dynamic equations in the RSW coordinate system [^4]. This is formed by:

[^4]: David A. Vallado and Wayne D. McClain, *Fundamentals of Astrodynamics and Applications*.

- The radial (R) component, which points away from the center of the Earth.
- The in-track (S) component, which points in the direction of velocity, perpendicular to R.
- The normal (W) component, which is aligned with the normal vector of the plane that contains the orbit.


Note that, by considering a 2D orbit, we may disregard the normal component. In such a system, the state variables for the space-craft are the distance to the earth \\(r\\), the angle from a given reference direction \\(θ\\), and the velocities in the radial direction \\(v_r\\) and the in-track direction \\(v_s\\). We can write the dynamic equations as <sup>4</sup>

$$
    \dv{r}{t} = v_r, \quad \dv{θ}{t} = \frac{v_s}{r}.
$$

Newton's second law can be written as <sup>4</sup> 

$$
    \dv{v_s}{t} = - \frac{v_r v_s}{r} + \frac{F_s}{m},
$$

$$
    \dv{v_r}{t} = \frac{v_s^2}{r} - \frac{μ}{r^2} + \frac{F_r}{m},
$$

where \\(m\\) is the mass of the spacecraft, which is assumed to remain constant. 

We have to decompose the solar sail force into the in-track \\(F_s\\) and radial \\(F_r\\) components. To do so, first consider the following decomposition of the thrust:


<img src="/Mathematics/solar-sail-img/solar-sail-schematic-1.svg" style="width:60%"></img>

Let's start with the component normal to the sail,

$$
    F_n = 𝐅 ⋅ 𝐧 = p A \abs{\cos(α)} ( (1 - ϵ) \cos(α) + 2 ϵ \cos(α)) = p A \abs{\cos(α)} \cos(α) (1 + ϵ)
$$

and a component in the tangential direction to the sail,

$$
    F_t = 𝐅 ⋅ 𝐭 = p A (1 - ϵ) \abs{\cos(α)} \sin(α).
$$

Note in this last expression that \\(𝐭\\) is formed by rotating \\(𝐧\\) by 90 degrees on the counter-clockwise direction, thus \\(𝐧 ⋅ 𝐭 = 0\\) and \\(𝐭 ⋅ 𝐬 = \cos(α - \frac{π}{2}) = \sin(α) \\). Intuitively, a fully specular reflective sail will only generate a force normal to itself (i.e. a pure pressure force), while a non-fully reflective sail will experience a tangential force on its surface. Note also that a reflective solar sail will always have a component of the force in the direction of the reflected light, instead of on the opposite direction (as one may be led to believe by quick intuition if you forget to consider the incident light), as the reflectivity \\( ϵ \\) may not be greater than 1.

We may consider \\( θ = 0 \\) to represent the direction of the sun, which shall remain fixed (this is of course, slightly unrealistic), and the orbit to take place in a counter-clockwise motion. Projecting the different vectors with the help of the diagram, we may write 

$$
    F_r = F_n \cos(α - θ) - F_t \cos\left( \frac{π}{2} - (α - θ)\right) = F_n \cos (α - θ) - F_t \sin(α - θ),
$$

$$
    F_s = F_n \cos\left(\frac{π}{2} - (α - θ)\right) + F_t \cos(α - θ) = F_n \sin(α - θ) + F_t \cos(α - θ).
$$

## The Hamiltonian

To find the optimal \\( α \\), we will maximize the energy of the orbit after time \\( t_f \\). We will follow a standard optimization procedure [^5]. To do so, we must introduce a Hamiltonian for the system

[^5]: A. E. Bryson, *Applied Optimal Control Optimization, Estimation and Control*, Chapter 2

$$
    H(t) = 𝛌(t) ⋅ 𝐟(𝐱(t), α(t), t),
$$

where \\( 𝛌 \\) is known as the lagrange multiplier vector (which we will explain later), and \\( 𝐟 \\) is the rate of change of the state vector of the system at each of its points. We can write down both vectors and carry out the dot product, to find the Hamiltonian

$$
    H = \begin{pmatrix}
        λ_r \\
        λ_θ \\
        λ_{v_s} \\ 
        λ_{v_r}
    \end{pmatrix}
    ⋅
    \underbrace{
    \begin{pmatrix}
        v_r\\
        \frac{v_s}{r}\\
        -\frac{v_r v_s}{r} + \frac{F_s (θ, α)}{m}\\
        \frac{v_s^2}{r} - \frac{μ}{r^2} + \frac{F_r (θ, α)}{m}
    \end{pmatrix}
    }_{𝐟}
    .
$$

Note that, for typical optimization problems, it's not neccesary to include \\( θ \\) in the Hamiltonian <sup>4</sup>, as it doesn't appear in the equations of motion nor is its value of particular importance for the problem. In our case, this angle is neccesary as the solar sail force greatly depends on its value. 

## Lagrange multipliers

The Hamiltonian defined before is useful, as finding its extremum guarantees that we find an extremum of the "performance index" <sup>5</sup>

$$
    \bar{J} = ϕ(𝐱(t_f), t_f) - 𝛌(t_f) ⋅𝐱(t_f) + 𝛌(t_0) ⋅ 𝐱(t_0) + ∫_{t_0}^{t_f} (H + \dv{𝛌}{t} ⋅ 𝐱) \dd{t}.
$$

We will demonstrate so, as done in <sup>5</sup>. Consider the variation of this index with a small change in control input, \\( \var{α} \\), and the induced change in state vector \\( \var{𝐱} \\). We assume the state vector at \\( t_0 \\) remains fixed. These variations cause a change in \\( \bar{J} \\) over the same interval of time as before,

$$
    \var{\bar{J}} = \eval{\pdv{ϕ}{𝐱}}_{t_f} ⋅ \var{𝐱} - 𝛌(t_f) ⋅ \var{𝐱} + ∫_{t_0}^{t_f} \left( \pdv{H}{𝐱} ⋅ \var{𝐱} + \pdv{H}{α} \var{α} + \dv{𝛌}{t} ⋅ \var{𝐱} \right)\dd{t}.
$$

It's of our greatest interest to choose \\(𝛌\\) in such a way that the previous expression simplifies. We may achieve so by having \\( 𝛌 \\) be a solution to

$$
    \dv{𝛌}{t} = - \pdv{H}{𝐱},
$$

with boundary conditions 

$$
    𝛌(t_f) = \eval{\pdv{ϕ}{𝐱}}_{t_f}.
$$

This achieves a well deserved simplification of our performance index, which is reduced to 

$$
    \var{\bar{J}} = ∫_{t_0}^{t_f} \pdv{H}{α} \var{α} \dd{t}.
$$

Clearly, by imposing \\( \pdv{H}{α} = 0 \\) we achieve \\( \var{\bar{J}} = 0 \\) and thus said trajectory finds an extremum of \\(\var{\bar{J}}\\).

Now, for our particular optimization problem, we have \\( ϕ = E = \frac{1}{2} 𝐯 ⋅ 𝐯 - \frac{μ}{\sqrt{𝐫 ⋅ 𝐫}} \\). We can write this expression down in the RSW coordinate system, giving 

$$
    ϕ = \frac{1}{2} (v_r^2 + (r v_s)^2) - \frac{μ}{r}.
$$

With this expression, we set the boundary conditons for 𝛌. Now, its evolution equation can be found by obtaining the gradient of the Hamiltonian with respect to the state vector. Using the definition of the Hamiltonian as \\( H = 𝛌 ⋅ 𝐟 \\), we can write

$$
    \dv{𝛌}{t} = - \begin{pmatrix}
        λ_r \\
        λ_θ \\
        λ_{v_s} \\ 
        λ_{v_r}
    \end{pmatrix}
    ⋅
    \begin{pmatrix}
        \pdv{f_r}{r} & \pdv{f_r}{θ} & \pdv{f_r}{v_s} & \pdv{f_r}{v_r} \\
        \pdv{f_θ}{r} & \pdv{f_θ}{θ} & \pdv{f_θ}{v_s} & \pdv{f_θ}{v_r} \\
        \pdv{f_{v_s}}{r} & \pdv{f_{v_s}}{θ} & \pdv{f_{v_s}}{v_s} & \pdv{f_{v_s}}{v_r} \\
        \pdv{f_{v_r}}{r} & \pdv{f_{v_r}}{θ} & \pdv{f_{v_r}}{v_s} & \pdv{f_{v_r}}{v_r} 
    \end{pmatrix}.
$$

Calculating all of the partial derivatives, we find that 

$$
    \dv{𝛌}{t} = - \begin{pmatrix}
        λ_r \\
        λ_θ \\
        λ_{v_s} \\ 
        λ_{v_r}
    \end{pmatrix}
    ⋅
    \begin{pmatrix}
        0 & 0 & 0 & 1 \\
        -\frac{v_s}{r^2} & 0 & \frac{1}{r} & 0 \\
        \frac{v_r v_s}{r^2} & \frac{1}{m}\pdv{F_s}{θ} & -\frac{v_r}{r} & -\frac{v_s}{r} \\
        -\frac{vs^2}{r^2} + \frac{2 μ}{r^3} & \frac{1}{m} \pdv{F_r}{θ} & \frac{2 v_s}{r} & 0
    \end{pmatrix}.
$$

We just have to substitute the partial derivatives of \\(F_s\\) and \\(F_r\\), which are

$$

$$

Note that the evolution equations for 𝛌 are valid for any problem. By ignoring the terms that depend on θ, you can check that this system reduces to the one given in <sup>4</sup>.

## Finding the optimal control law

We can find this control law by setting the partial of the Hamiltonian with respect to the control input equal to zero. As only two terms depend on α, this reduces to 

$$
    \pdv{H}{α} = \frac{λ_{v_s}}{m} \pdv{F_s}{α} + \frac{λ_{v_r}}{m} \pdv{F_r}{α} = 0 
$$



## Solving the system

The "dynamic equations" for 𝛌, alongside the 


## Linearized solution
